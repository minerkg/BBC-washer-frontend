<div class="p-grid p-justify-center p-align-center p-mt-5">
  <div class="p-col-12 p-md-8 p-lg-6">

    <p-card styleClass="p-shadow-24">

      <div class="p-fluid p-mb-4">
        <div *ngIf="reservations && reservations.length > 0; else noReservations">

          <span class="p-input-icon-left" style="width: 250px; margin-bottom: 0.5rem;">
            <i class="pi pi-search"></i>
            <input
              type="text"
              pInputText
              placeholder="Search reservations..."
              [(ngModel)]="reservationSearchQuery"
            />
          </span>
        </div>

        <p-table
          [value]="filteredReservations"
          [paginator]="true"
          [rows]="5"
          [rowsPerPageOptions]="[5,10,20]"
          [globalFilterFields]="[
            'bookableUnit.washer.name',
            'bookableUnit.washer.capacity',
            'bookableUnit.timeSlot.timeInterval.date',
            'bookableUnit.timeSlot.timeInterval.startTime',
            'status'
          ]"
          class="p-datatable-sm"
          [tableStyle]="{ 'min-width': '50rem' }"
        >

          <ng-template pTemplate="header">
            <tr>
              <th>Reservation ID</th>
              <th>Washer Name</th>
              <th>Capacity</th>
              <th>Date</th>
              <th>Time Slot</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-reservation>
            <tr>
              <td>{{ reservation.id }}</td>
              <td>{{ reservation.bookableUnit?.washer?.name || 'N/A' }}</td>
              <td>{{ reservation.bookableUnit?.washer?.capacity || 'N/A' }} kg</td>
              <td>{{ reservation.bookableUnit?.timeSlot?.timeInterval?.date }}</td>
              <td>{{ reservation.bookableUnit?.timeSlot?.timeInterval?.startTime }}
                - {{ reservation.bookableUnit?.timeSlot?.timeInterval?.endTime }}
              </td>
              <td>
                <p-tag [value]="reservation.status" [severity]="getSeverity(reservation.status)"></p-tag>
              </td>
              <td>
                <p-button *ngIf="reservation.status === 'CONFIRMED'"
                          icon="pi pi-power-off"
                          styleClass="p-button-danger p-button-sm"
                          (onClick)="confirmCancel(reservation.id)"
                          pTooltip="Cancel reservation"
                          tooltipPosition="top"/>
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="emptyMessage">
            <tr>
              <td colspan="7">No reservations found.</td>
            </tr>
          </ng-template>
        </p-table>
      </div>

      <ng-template #noReservations>
        <div class="p-message p-message-info mt-5" style="display: block;">
          <div class="p-message-wrapper">
            <span class="p-message-icon pi pi-info-circle"></span>
            <span class="p-message-text">You currently have no active or completed reservations.</span>
          </div>
        </div>
      </ng-template>

    </p-card>
  </div>
</div>
<p-toast></p-toast>
<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="1000"></p-confirmDialog>
